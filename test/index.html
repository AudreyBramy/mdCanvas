<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8">
      <title>QUnit 2.2.0 Example</title>
      <link rel="stylesheet" href="qunit-2.2.0.css">
   </head>
   <body>
      <div id="qunit"></div>
      <div id="qunit-fixture"></div>
      <script src="qunit-2.2.0.js"></script>
	  <!-- 
		https://www.sitepoint.com/getting-started-qunit/
	  	Same as in the module.html, had to adapt relative path 

		Added systemjs and the things, as I am not sure that qunit can 
		handle es6

		@todo Perhaps add the feature to load the tests via Javascript
		http://davidvujic.blogspot.de/2015/03/es6-and-tdd-can-i-test-it.html
	  -->
	  <script src="../js/systemjs/dist/system.js"></script>
	  <script>
		SystemJS.import('https://code.jquery.com/jquery.js');

		SystemJS.config({
		  map: {
			'plugin-babel': '../js/plugin-babel/plugin-babel.js',
			'systemjs-babel-build': '../js/plugin-babel/systemjs-babel-browser.js'
		  },
		  transpiler: 'plugin-babel'
		});

	  </script>
	  <!-- same as in the module.html -->
	  <script type="text/javascript" charset="utf-8">
		SystemJS.import('../js/modules/mdCanvas.js').then( function( qob ) { 
	  	
			var use = new qob.main;
			// console.log( new qob.main(  ).say );
			// console.log( use.say );
			// QUnit.module( "Get md files from url" ); // not sure how to use this
			QUnit.test( "getFilenameFrom - get filename from url", function( assert ) { 
				assert.equal( use.getFilenameFrom(  ), "mdCanvas", "Default md-file mdCanvas is true" );
				assert.equal( use.getFilenameFrom( 'md=mdFoo'), "mdFoo", "md-file mdFoo is true" );
				assert.equal( use.getFilenameFrom( 'md=mdFoo&foo=bar'), "mdFoo", "md-file mdFoo is true" );
				assert.equal( use.getFilenameFrom( 'mdx=mdFoo&foo=bar'), "mdCanvas", "Default md-file mdCanvas is true" );
			} );

			/*
			// there is no return methode on this function, the tests make no sense
			QUnit.test( 'getFile content of the md-file', function( assert ) { 
				assert.notOk( use.getFile(  ) , 'There is no file content, missing filename parameter'  );
				assert.notOk( use.getFile( 'mdFoo' ), 'There is no file content, filename does not exists' );
				// hard to test, as it is async. 
				//assert.ok( use.getFile( 'mdCanvas' ).includes( '#' ), 'There is file content' );
			} );
			*/

			QUnit.test( 'parseSections - split file in sections for the canvas boxes', function( assert ) { 
					var content = "# Canvas \n#Section";
					assert.ok( Array.isArray(use.parseSections( content )), 'Return value is an array' );
					assert.ok( use.parseSections( content ), 'There are sections' );
					assert.ok( use.parseSections( ) instanceof Error, 'There is missing content. Error thrown' );
					assert.ok( use.parseSections( 'no sections' ).length == 1, 'There are no sections' );
			} )

			QUnit.test( "say - smoketest", function( assert ) {
				var checkString = "es6";
				//assert.ok( use.say.includes( checkString ), "String contains" + checkString);
				// http://es6-features.org/#StringInterpolation
				assert.ok( use.say.includes( checkString ), `String containts ${ checkString }`);
			} );

		} );

	  </script>
   </body>
</html>
